<!DOCTYPE html>
<html>
<head>
    <title>Teste Direto - Sem Firebase</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        button { background: #007bff; color: white; padding: 15px; border: none; border-radius: 5px; cursor: pointer; margin: 10px; }
        .resultado { background: #f0f0f0; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>üîß Teste Direto - Verificar Problema</h1>
    <p>Este teste vai verificar se o problema √© com o Firebase ou com a agenda.</p>
    
    <button onclick="verificarRede()">1. Verificar Rede</button>
    <button onclick="verificarFirebase()">2. Verificar Firebase</button>
    <button onclick="criarAgendamentoDireto()">3. Criar Agendamento Direto</button>
    
    <div id="resultado" class="resultado">Clique nos bot√µes em sequ√™ncia...</div>

    <script>
        async function verificarRede() {
            const div = document.getElementById('resultado');
            div.innerHTML = 'üîÑ Verificando rede...';
            
            try {
                // Testar se consegue acessar Google
                const response = await fetch('https://www.google.com', { mode: 'no-cors' });
                div.innerHTML = '‚úÖ Rede OK!<br>';
            } catch (error) {
                div.innerHTML = '‚ùå Problema de rede: ' + error.message + '<br>';
            }
        }

        async function verificarFirebase() {
            const div = document.getElementById('resultado');
            div.innerHTML += 'üîÑ Verificando Firebase...<br>';
            
            // Tentar carregar Firebase manualmente
            const script = document.createElement('script');
            script.src = 'https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js';
            script.onload = () => {
                div.innerHTML += '‚úÖ Firebase App carregado!<br>';
                
                const script2 = document.createElement('script');
                script2.src = 'https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js';
                script2.onload = () => {
                    div.innerHTML += '‚úÖ Firebase Firestore carregado!<br>';
                    div.innerHTML += '‚úÖ Firebase pronto para uso!<br>';
                };
                script2.onerror = () => {
                    div.innerHTML += '‚ùå Erro ao carregar Firestore<br>';
                };
                document.head.appendChild(script2);
            };
            script.onerror = () => {
                div.innerHTML += '‚ùå Erro ao carregar Firebase App<br>';
            };
            document.head.appendChild(script);
        }

        async function criarAgendamentoDireto() {
            const div = document.getElementById('resultado');
            div.innerHTML += 'üîÑ Tentando criar agendamento...<br>';
            
            if (typeof firebase === 'undefined') {
                div.innerHTML += '‚ùå Firebase ainda n√£o carregado!<br>';
                return;
            }
            
            try {
                const firebaseConfig = {
                    apiKey: "AIzaSyBPd-t8X34vBzGqGM2XTSpxGh8lUdQe4jo",
                    authDomain: "estetica-anamnese.firebaseapp.com",
                    projectId: "estetica-anamnese",
                    storageBucket: "estetica-anamnese.firebasestorage.app",
                    messagingSenderId: "610199167597",
                    appId: "1:610199167597:web:5a234a65466614408ad564"
                };

                const app = firebase.initializeApp(firebaseConfig);
                const db = firebase.firestore();

                const hoje = new Date();
                hoje.setHours(19, 0, 0, 0);
                
                const doc = await db.collection('agendamentos').add({
                    clienteNome: 'Teste Direto',
                    procedimento: 'Teste',
                    dataHora: firebase.firestore.Timestamp.fromDate(hoje),
                    status: 'agendado',
                    clinicaId: 'estetica-rho'
                });

                div.innerHTML += `<span class="success">‚úÖ Agendamento criado: ${doc.id}</span><br>`;
                div.innerHTML += `<span class="success">‚úÖ Data: ${hoje.toLocaleString('pt-BR')}</span><br>`;
                div.innerHTML += '<br><span class="success">üéâ SUCESSO! Agora v√° para a Agenda!</span>';

            } catch (error) {
                div.innerHTML += `<span class="error">‚ùå Erro: ${error.message}</span><br>`;
                console.error('Erro completo:', error);
            }
        }
    </script>
</body>
</html>
