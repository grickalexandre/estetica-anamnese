# üìö Documenta√ß√£o Completa do Projeto - Sistema de Anamnese Est√©tica

**Projeto**: Sistema de Gest√£o de Cl√≠nica de Est√©tica  
**Tecnologias**: Vue.js 3, Firebase/Firestore, Vercel, Cloudinary  
**Tipo**: PWA (Progressive Web App)  
**Data √∫ltima atualiza√ß√£o**: Outubro 2025

---

## üìã √çndice

1. [Vis√£o Geral](#vis√£o-geral)
2. [Arquitetura do Sistema](#arquitetura-do-sistema)
3. [Documenta√ß√£o de Funcionalidades](#documenta√ß√£o-de-funcionalidades)
4. [Componentes Vue](#componentes-vue)
5. [Composables (L√≥gica Reutiliz√°vel)](#composables)
6. [Firebase e Firestore](#firebase-e-firestore)
7. [Integra√ß√µes Externas](#integra√ß√µes-externas)
8. [Guias e Tutoriais](#guias-e-tutoriais)
9. [Estrutura de Pastas](#estrutura-de-pastas)

---

## üéØ Vis√£o Geral

### Objetivo do Projeto
Sistema completo de gest√£o para cl√≠nicas de est√©tica que oferece:
- Gest√£o de pacientes e anamneses
- Agendamento e controle de atendimentos
- Cat√°logo de procedimentos
- Controle de estoque de produtos
- Gest√£o financeira (contas a pagar/receber, fluxo de caixa)
- Sistema de comiss√µes para profissionais
- Relat√≥rios e dashboards anal√≠ticos

### Caracter√≠sticas Principais
- ‚úÖ **PWA (Progressive Web App)** - Funciona offline e pode ser instalado
- ‚úÖ **Mobile-First** - Otimizado para celular e tablet
- ‚úÖ **Multi-tenancy** - Suporta m√∫ltiplas cl√≠nicas
- ‚úÖ **Sistema de Notifica√ß√µes Moderno** - Toast e modais mobile-friendly
- ‚úÖ **Upload de Imagens** - Integra√ß√£o com Cloudinary
- ‚úÖ **Real-time** - Dados sincronizados via Firebase

---

## üèóÔ∏è Arquitetura do Sistema

### Stack Tecnol√≥gico

#### Frontend
- **Vue.js 3** (Composition API)
- **Vue Router** (navega√ß√£o)
- **CSS3** (design responsivo)
- **Font Awesome** (√≠cones)

#### Backend/Database
- **Firebase Authentication** (autentica√ß√£o)
- **Firestore** (banco de dados NoSQL)
- **Firebase Storage** (arquivos)

#### Hospedagem & CDN
- **Vercel** (deploy e hosting)
- **Cloudinary** (upload e otimiza√ß√£o de imagens)

#### Build & Deploy
- **Vite** (build tool)
- **Git/GitHub** (controle de vers√£o)
- **CI/CD** (deploy autom√°tico via Vercel)

### Padr√£o de Arquitetura
- **Composables Pattern** - L√≥gica reutiliz√°vel
- **Component-Based** - Componentes modulares
- **State Management** - Reactive refs compartilhados
- **Multi-tenancy** - Isolamento por `clinicaId`

---

## üìù Documenta√ß√£o de Funcionalidades

### Documentos Principais

#### 1. `RELACIONAMENTO_FIREBASE.md`
**Descri√ß√£o**: Diagrama ER e estrutura das cole√ß√µes Firestore  
**Conte√∫do**:
- Cole√ß√µes do Firebase (anamneses, clientes, agendamentos, etc)
- Relacionamentos entre entidades
- √çndices necess√°rios
- Queries otimizadas

#### 2. `DIAGRAMA_IMPLEMENTADO.md`
**Descri√ß√£o**: Confirma√ß√£o da implementa√ß√£o do diagrama ER  
**Conte√∫do**:
- Status de implementa√ß√£o de cada entidade
- Relacionamentos implementados
- Foreign keys e refer√™ncias

#### 3. `GUIA_FICHAS_CLIENTES.md`
**Descri√ß√£o**: Sistema de fichas/anamneses de clientes  
**Conte√∫do**:
- Como criar anamnese p√∫blica (cliente preenche)
- Como criar anamnese interna (profissional preenche)
- Campos da anamnese
- Upload de fotos
- Sistema de status (pendente/analisada)

#### 4. `SISTEMA_BAIXA_CONTAS.md`
**Descri√ß√£o**: Sistema de baixa de contas a pagar/receber  
**Conte√∫do**:
- Como dar baixa em contas
- Registro de pagamentos/recebimentos
- Integra√ß√£o com fluxo de caixa
- Controle de status (pendente/pago/parcial)

#### 5. `PARCELAMENTO_SISTEMA.md`
**Descri√ß√£o**: Sistema de parcelamento de despesas e receitas  
**Conte√∫do**:
- Como criar contas parceladas
- Gera√ß√£o autom√°tica de parcelas
- Controle de vencimentos
- Fun√ß√µes do composable

#### 6. `INCONSISTENCIAS_CORRIGIDAS.md`
**Descri√ß√£o**: Corre√ß√µes de inconsist√™ncias de formul√°rios  
**Conte√∫do**:
- Problemas identificados
- Solu√ß√µes implementadas
- Padroniza√ß√£o de formul√°rios

#### 7. `FIRESTORE_RULES_GUIDE.md` *(Deletado)*
**Descri√ß√£o**: Guia de regras de seguran√ßa do Firestore  
**Status**: Substitu√≠do por `APLICAR_REGRAS_FIREBASE.md`

#### 8. `APLICAR_REGRAS_FIREBASE.md`
**Descri√ß√£o**: Como aplicar regras de seguran√ßa no Firebase  
**Conte√∫do**:
- Regras de seguran√ßa atuais
- Como atualizar via console Firebase
- Autentica√ß√£o e autoriza√ß√£o
- Regras por cole√ß√£o

#### 9. `SOLUCAO_UPLOAD_CLOUDINARY.md`
**Descri√ß√£o**: Implementa√ß√£o de upload de imagens via Cloudinary  
**Conte√∫do**:
- Configura√ß√£o do Cloudinary
- Presets de upload
- Compress√£o de imagens
- Tratamento de erros
- Upload profiles vs anamneses

#### 10. `SUBSTITUICOES_POPUPS_PENDENTES.md`
**Descri√ß√£o**: Controle de substitui√ß√£o de popups por notifica√ß√µes mobile  
**Conte√∫do**:
- Arquivos j√° atualizados
- Arquivos pendentes
- Padr√µes de substitui√ß√£o
- Progresso da migra√ß√£o

---

## üß© Componentes Vue

### Views (P√°ginas Principais)

#### üìÅ **Cadastros**
1. **`NovaAnamnese.vue`**
   - Cria√ß√£o de anamnese pela profissional
   - Upload de foto do paciente
   - Formul√°rio completo de anamnese
   - Integra√ß√£o com `usePacientes`

2. **`AnamneseCliente.vue`**
   - Anamnese p√∫blica para clientes
   - Link p√∫blico compartilh√°vel
   - Formul√°rio simplificado
   - Upload de m√∫ltiplas fotos

3. **`ListaAnamneses.vue`**
   - Lista de pacientes cadastrados
   - Filtros e pagina√ß√£o
   - Sistema de busca
   - A√ß√µes: ver detalhes, editar, excluir

4. **`DetalhesAnamnese.vue`**
   - Visualiza√ß√£o completa da anamnese
   - Foto do paciente
   - Dados pessoais e hist√≥rico m√©dico
   - Status de an√°lise

5. **`EditarPaciente.vue`**
   - Edi√ß√£o de dados do paciente
   - Upload/altera√ß√£o de foto
   - Atualiza√ß√£o de anamnese
   - Sincroniza√ß√£o com agendamentos

6. **`CatalogoProcedimentos.vue`**
   - CRUD de procedimentos est√©ticos
   - Categorias (facial, corporal, capilar, etc)
   - Valores e dura√ß√µes
   - Produtos utilizados
   - Filtros e pagina√ß√£o

7. **`Produtos.vue`**
   - CRUD de produtos
   - Controle de estoque
   - Alertas de validade
   - Movimenta√ß√£o de estoque
   - Pre√ßos (custo e venda)

8. **`Fornecedores.vue`**
   - CRUD de fornecedores
   - Dados de contato
   - Status ativo/inativo

9. **`Profissionais.vue`**
   - CRUD de profissionais
   - Especialidades
   - Configura√ß√£o de comiss√µes
   - Registro profissional

#### üìÅ **Atendimento**
10. **`Agenda.vue`**
    - Calend√°rio de agendamentos
    - Visualiza√ß√£o semanal e mensal
    - CRUD de agendamentos
    - Status (confirmado, realizado, cancelado)
    - Upload de foto do paciente no agendamento
    - Filtros por profissional/procedimento

11. **`RegistrarAtendimento.vue`** *(Removido do menu)*
    - Registro de atendimento avulso
    - M√∫ltiplos procedimentos
    - Controle financeiro
    - Baixa autom√°tica de estoque

12. **`RegistrarAtendimentoAgendado.vue`**
    - Lista de atendimentos agendados
    - Registro de atendimento para agendados
    - Filtros por cliente e data
    - Status de confirma√ß√£o
    - √çcones no combobox

#### üìÅ **Financeiro**
13. **`Financeiro.vue`**
    - Dashboard financeiro
    - Resumo de receitas e despesas
    - Saldo do per√≠odo
    - Cards informativos

14. **`ContasPagar.vue`**
    - Contas a pagar
    - Controle de vencimentos
    - Baixa de contas
    - Categoriza√ß√£o

15. **`ContasReceber.vue`**
    - Contas a receber
    - Controle de recebimentos
    - Baixa de contas
    - Categoriza√ß√£o

16. **`FluxoCaixa.vue`**
    - Movimenta√ß√µes financeiras
    - Entradas e sa√≠das
    - Saldo consolidado
    - Filtros por per√≠odo

17. **`PlanoContas.vue`**
    - Categorias financeiras
    - Plano de contas padr√£o
    - Personaliza√ß√£o de categorias

18. **`DespesasRecorrentes.vue`**
    - Despesas fixas mensais
    - Gera√ß√£o autom√°tica de contas
    - Controle de vencimentos

19. **`EntradaProdutos.vue`**
    - Entrada de produtos no estoque
    - Registro de compras
    - Gera√ß√£o de conta a pagar
    - Associa√ß√£o com fornecedor

20. **`Comissoes.vue`**
    - Comiss√µes de profissionais
    - C√°lculo autom√°tico
    - Pagamento de comiss√µes
    - Filtros e relat√≥rios

#### üìÅ **Relat√≥rios**
21. **`RelatorioAtendimentos.vue`**
    - Relat√≥rio de atendimentos
    - Filtros por per√≠odo
    - Exporta√ß√£o (planejada)

22. **`Dashboard.vue`**
    - KPIs principais
    - Gr√°ficos e estat√≠sticas
    - Vis√£o geral do neg√≥cio

#### üìÅ **Configura√ß√µes**
23. **`Configuracoes.vue`**
    - Dados da cl√≠nica
    - Informa√ß√µes do propriet√°rio
    - Upload de foto do profissional
    - Hor√°rios de atendimento

24. **`LimpezaDados.vue`**
    - Limpeza de dados de teste
    - Exclus√£o em massa
    - Confirma√ß√µes de seguran√ßa

#### üìÅ **Autentica√ß√£o**
25. **`Login.vue`**
    - Tela de login
    - Autentica√ß√£o Firebase
    - Recupera√ß√£o de senha

26. **`Cadastro.vue`**
    - Cadastro de nova cl√≠nica
    - Cria√ß√£o de conta
    - Inicializa√ß√£o de dados

#### üìÅ **Home**
27. **`Home.vue`**
    - P√°gina inicial
    - Bot√µes de acesso r√°pido
    - Informa√ß√µes da cl√≠nica
    - Cards de funcionalidades

---

### Componentes Reutiliz√°veis

#### **Navega√ß√£o**
1. **`Sidebar.vue`**
   - Menu lateral desktop
   - Navega√ß√£o por m√≥dulos
   - Indicador de anamneses pendentes
   - Bot√£o de collapse
   - Ajuste din√¢mico de espa√ßo

2. **`MobileMenu.vue`**
   - Menu mobile (bottom navigation)
   - √çcones touch-friendly
   - Navega√ß√£o responsiva

3. **`VoltarHome.vue`**
   - Bot√£o de voltar para Home
   - Reutiliz√°vel em todas as p√°ginas

#### **Filtros e Pagina√ß√£o**
4. **`Filtros.vue`**
   - Sistema de filtros universal
   - Layout mobile/desktop
   - Filtros colaps√°veis no mobile
   - Busca, status, categoria, data

5. **`Paginacao.vue`**
   - Controles de pagina√ß√£o
   - Layout mobile/desktop
   - Sele√ß√£o de itens por p√°gina
   - Navega√ß√£o entre p√°ginas

#### **Notifica√ß√µes (Sistema Novo - Mobile-Friendly)**
6. **`Toast.vue`**
   - Notifica√ß√µes toast
   - 4 tipos: success, error, warning, info
   - Anima√ß√µes suaves
   - Auto-dismiss configur√°vel
   - Posicionamento responsivo

7. **`ConfirmModal.vue`**
   - Modal de confirma√ß√£o
   - Bot√µes touch-friendly (48px)
   - 4 tipos visuais
   - Backdrop blur
   - Layout empilhado no mobile

8. **`PromptModal.vue`**
   - Modal de input
   - Suporte a v√°rios tipos de input
   - Valida√ß√£o
   - Focus autom√°tico
   - Enter para confirmar

---

## üîß Composables (L√≥gica Reutiliz√°vel)

### Composables Principais

1. **`useAuth.js`**
   - Autentica√ß√£o Firebase
   - Login/Logout
   - Gerenciamento de sess√£o
   - Guards de rota

2. **`useClinica.js`**
   - Gerenciamento do `clinicaId`
   - Multi-tenancy
   - Inicializa√ß√£o de cl√≠nica

3. **`usePacientes.js`**
   - CRUD de pacientes
   - Busca ou cria√ß√£o de cliente
   - Atualiza√ß√£o de dados
   - Incremento de contadores

4. **`useProcedimentos.js`**
   - CRUD de procedimentos
   - Cat√°logo de procedimentos
   - Busca e filtros
   - Estat√≠sticas

5. **`useProdutos.js`**
   - CRUD de produtos
   - Controle de estoque
   - Alertas de validade
   - C√°lculo de status

6. **`useEstoque.js`**
   - Movimenta√ß√£o de estoque
   - Entrada e sa√≠da
   - Hist√≥rico de movimenta√ß√µes

7. **`useProfissionais.js`**
   - CRUD de profissionais
   - Dados profissionais
   - Estat√≠sticas

8. **`useAgendamento.js`**
   - CRUD de agendamentos
   - Busca com atualiza√ß√£o de fotos
   - Verifica√ß√£o de conflitos
   - Estat√≠sticas

9. **`useFinanceiro.js`**
   - Contas a pagar/receber
   - Movimenta√ß√µes financeiras
   - Parcelamento
   - Baixa de contas

10. **`useComissoes.js`**
    - C√°lculo de comiss√µes
    - Pagamento
    - Filtros e relat√≥rios

11. **`useFornecedores.js`**
    - CRUD de fornecedores
    - Gerenciamento de dados

12. **`useCompras.js`**
    - Entrada de produtos
    - Registro de compras

13. **`useDespesasRecorrentes.js`**
    - Despesas fixas
    - Gera√ß√£o autom√°tica

14. **`useConfiguracoes.js`**
    - Configura√ß√µes da cl√≠nica
    - Dados do propriet√°rio

15. **`useKPIs.js`**
    - C√°lculo de KPIs
    - M√©tricas do dashboard

16. **`usePaginacao.js`**
    - L√≥gica de pagina√ß√£o
    - Controle de p√°ginas
    - Itens por p√°gina

17. **`useFiltros.js`**
    - L√≥gica de filtros
    - Busca e ordena√ß√£o
    - Filtros ativos

18. **`useNotifications.js`** *(NOVO)*
    - Sistema de notifica√ß√µes global
    - Toast, Confirm e Prompt
    - Estado compartilhado
    - Promises para confirma√ß√µes

---

## üî• Firebase e Firestore

### Estrutura de Cole√ß√µes

#### Principais Cole√ß√µes

1. **`anamneses`**
   - Fichas de anamnese dos pacientes
   - Campos: nome, telefone, dataNascimento, cpf, email, endereco, doencas, medicamentos, alergias, gestante, lactante, fumante, tipoPele, protetorSolar, exposicaoSol, produtosCosmeticos, objetivos, procedimentosAnteriores, observacoes, fotos, fotoURL, status, origem, clinicaId, clienteId, dataCriacao

2. **`clientes`**
   - Cadastro de clientes/pacientes
   - Campos: nome, telefone, cpf, email, dataNascimento, endereco, fotoURL, ativo, clinicaId, totalAnamneses, dataCriacao, dataAtualizacao

3. **`agendamentos`**
   - Agendamentos de procedimentos
   - Campos: clienteId, clienteNome, pacienteFoto, profissionalId, profissionalNome, procedimentoId, procedimento, dataHora, duracao, valorEstimado, status, observacoes, clinicaId, dataCriacao

4. **`catalogo_procedimentos`**
   - Cat√°logo de procedimentos oferecidos
   - Campos: nome, categoria, valor, duracao, sessoesRecomendadas, descricao, observacoes, produtosUtilizados, ativo, totalRealizados, clinicaId, dataCriacao, dataAtualizacao

5. **`produtos`**
   - Produtos e insumos
   - Campos: nome, categoria, marca, estoqueAtual, estoqueMinimo, estoqueMaximo, precoCusto, precoVenda, unidade, dataValidade, statusValidade, observacoes, ativo, clinicaId, dataCriacao

6. **`fornecedores`**
   - Fornecedores de produtos
   - Campos: nome, cnpj, telefone, email, endereco, observacoes, ativo, clinicaId, dataCriacao

7. **`profissionais`**
   - Profissionais da cl√≠nica
   - Campos: nome, especialidade, registroProfissional, telefone, email, percentualComissao, tipoComissao, observacoes, ativo, clinicaId, dataCriacao

8. **`atendimentos`**
   - Registro de atendimentos realizados
   - Campos: clienteId, clienteNome, profissionalId, profissionalNome, procedimentos[], produtosUtilizados[], valorTotal, formaPagamento, observacoes, clinicaId, dataAtendimento

9. **`contas_pagar`**
   - Contas a pagar
   - Campos: descricao, valor, categoria, vencimento, status, fornecedorId, observacoes, clinicaId, dataCriacao

10. **`contas_receber`**
    - Contas a receber
    - Campos: descricao, valor, categoria, vencimento, status, clienteId, observacoes, clinicaId, dataCriacao

11. **`movimentacoes_financeiras`**
    - Movimenta√ß√µes de caixa
    - Campos: tipo, valor, categoria, descricao, data, clinicaId

12. **`estoque_movimentacoes`**
    - Hist√≥rico de movimenta√ß√µes de estoque
    - Campos: produtoId, produtoNome, tipo, quantidade, motivo, clinicaId, data

13. **`comissoes`**
    - Comiss√µes dos profissionais
    - Campos: profissionalId, profissionalNome, atendimentoId, valor, percentual, status, dataPagamento, clinicaId, dataCriacao

14. **`despesas_recorrentes`**
    - Despesas fixas mensais
    - Campos: descricao, valor, categoria, diaVencimento, ativo, clinicaId, dataCriacao

15. **`configuracoes`**
    - Configura√ß√µes da cl√≠nica
    - Campos: nomeClinica, cnpj, endereco, telefone, whatsapp, email, website, nomeProprietario, registroProfissional, fotoProfissional, formacao, experiencia, especialidades, horarioSegSex, horarioSabado, observacoesHorarios, clinicaId

16. **`users`**
    - Usu√°rios do sistema
    - Campos: uid, email, clinicaId, role, dataCriacao

### Regras de Seguran√ßa (firestore.rules)

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    function isAuthenticated() {
      return request.auth != null;
    }
    
    function belongsToClinica() {
      return resource.data.clinicaId == request.auth.token.clinicaId;
    }
    
    // Anamneses e Clientes - Acesso p√∫blico para cria√ß√£o
    match /anamneses/{anamneseId} {
      allow read, write: if true;
    }
    
    match /clientes/{clienteId} {
      allow read, write: if true;
    }
    
    // Demais cole√ß√µes - Autenticadas e por cl√≠nica
    match /agendamentos/{agendamentoId} {
      allow read, write: if isAuthenticated();
    }
    
    match /catalogo_procedimentos/{procedimentoId} {
      allow read, write: if isAuthenticated();
    }
    
    match /produtos/{produtoId} {
      allow read, write: if isAuthenticated();
    }
    
    match /fornecedores/{fornecedorId} {
      allow read, write: if isAuthenticated();
    }
    
    match /profissionais/{profissionalId} {
      allow read, write: if isAuthenticated();
    }
    
    match /atendimentos/{atendimentoId} {
      allow read, write: if isAuthenticated();
    }
    
    match /contas_pagar/{contaId} {
      allow read, write: if isAuthenticated();
    }
    
    match /contas_receber/{contaId} {
      allow read, write: if isAuthenticated();
    }
    
    match /movimentacoes_financeiras/{movId} {
      allow read, write: if isAuthenticated();
    }
    
    match /estoque_movimentacoes/{movId} {
      allow read, write: if isAuthenticated();
    }
    
    match /comissoes/{comissaoId} {
      allow read, write: if isAuthenticated();
    }
    
    match /despesas_recorrentes/{despesaId} {
      allow read, write: if isAuthenticated();
    }
    
    match /configuracoes/{clinicaId} {
      allow read, write: if isAuthenticated();
    }
    
    match /users/{userId} {
      allow read, write: if isAuthenticated();
    }
  }
}
```

### √çndices Necess√°rios

Para queries complexas, os seguintes √≠ndices s√£o necess√°rios:

1. **agendamentos**: `clinicaId` (ASC) + `dataHora` (ASC)
2. **atendimentos**: `clinicaId` (ASC) + `dataAtendimento` (DESC)
3. **contas_pagar**: `clinicaId` (ASC) + `vencimento` (ASC)
4. **contas_receber**: `clinicaId` (ASC) + `vencimento` (ASC)
5. **produtos**: `clinicaId` (ASC) + `statusValidade` (ASC)

---

## üåê Integra√ß√µes Externas

### Cloudinary (Upload de Imagens)

#### Configura√ß√£o
```javascript
// src/utils/cloudinary.js
cloudName: 'dkliyeyoq'
apiKey: '655279166963564'
uploadPreset: 'pacientes' ou 'profissionais'
```

#### Presets Configurados
1. **`pacientes`** - Para fotos de pacientes/anamneses
2. **`profissionais`** - Para fotos de profissionais

#### Compress√£o de Imagens
```javascript
// src/utils/imageCompressor.js
- compressProfileImage() - Max 800x800, 80% quality
- compressAnamneseImage() - Max 1920x1920, 85% quality
- isValidImage() - Valida√ß√£o de tipo e tamanho
```

#### Fun√ß√µes Principais
```javascript
// Upload
uploadToCloudinary(file, options)

// Valida√ß√£o
isValidImage(file)

// Compress√£o
compressProfileImage(file)
compressAnamneseImage(file)
```

### Firebase/Firestore

#### Configura√ß√£o
```javascript
// src/firebase.js
apiKey: process.env.VITE_FIREBASE_API_KEY
authDomain: "estetica-anamnese.firebaseapp.com"
projectId: "estetica-anamnese"
storageBucket: "estetica-anamnese.appspot.com"
messagingSenderId: "..."
appId: "..."
```

### Vercel (Deploy)

#### Configura√ß√£o
- **Framework**: Vite
- **Build Command**: `npm run build`
- **Output Directory**: `dist`
- **Deploy**: Autom√°tico via Git push

---

## üìñ Guias e Tutoriais

### Guias de Uso

#### Como Criar uma Anamnese P√∫blica
1. Acessar `/anamnese-cliente`
2. Preencher formul√°rio
3. Fazer upload de fotos (opcional)
4. Submeter
5. Sistema cria/atualiza cliente automaticamente

#### Como Registrar um Atendimento
1. Acessar `Agenda` ou `Registrar Atendimento Agendado`
2. Selecionar cliente
3. Selecionar procedimento(s)
4. Definir profissional
5. Preencher valores e forma de pagamento
6. Salvar (estoque baixado automaticamente)

#### Como Gerenciar Estoque
1. **Entrada**: Usar `Entrada de Produtos`
2. **Sa√≠da Manual**: Usar bot√£o de movimenta√ß√£o em `Produtos`
3. **Sa√≠da Autom√°tica**: Ocorre ao registrar atendimento
4. **Alertas**: Dashboard mostra produtos vencendo/vencidos

#### Como Configurar Comiss√µes
1. Cadastrar profissional em `Profissionais`
2. Definir percentual de comiss√£o
3. Comiss√µes geradas automaticamente ao registrar atendimento
4. Pagar comiss√µes em `Comiss√µes`

---

## üìÅ Estrutura de Pastas

```
estetica-anamnese/
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ favicon.ico
‚îÇ   ‚îî‚îÄ‚îÄ manifest.json (PWA)
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ assets/          # Imagens, CSS global
‚îÇ   ‚îú‚îÄ‚îÄ components/      # Componentes reutiliz√°veis
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MobileMenu.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ VoltarHome.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Filtros.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Paginacao.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Toast.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ConfirmModal.vue
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PromptModal.vue
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ composables/     # L√≥gica reutiliz√°vel
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAuth.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useClinica.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usePacientes.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useProcedimentos.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useProdutos.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useEstoque.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useProfissionais.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAgendamento.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useFinanceiro.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useComissoes.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useFornecedores.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useCompras.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useDespesasRecorrentes.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useConfiguracoes.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useKPIs.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usePaginacao.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useFiltros.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useNotifications.js
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ utils/           # Fun√ß√µes utilit√°rias
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cloudinary.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ imageCompressor.js
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ views/           # P√°ginas/Views
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Home.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Login.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Cadastro.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NovaAnamnese.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AnamneseCliente.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ListaAnamneses.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DetalhesAnamnese.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EditarPaciente.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CatalogoProcedimentos.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Produtos.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Fornecedores.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Profissionais.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Agenda.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RegistrarAtendimento.vue (removido do menu)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RegistrarAtendimentoAgendado.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Financeiro.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ContasPagar.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ContasReceber.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FluxoCaixa.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PlanoContas.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DespesasRecorrentes.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EntradaProdutos.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Comissoes.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RelatorioAtendimentos.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.vue
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Configuracoes.vue
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LimpezaDados.vue
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ App.vue          # Componente raiz
‚îÇ   ‚îú‚îÄ‚îÄ main.js          # Entry point + Router
‚îÇ   ‚îî‚îÄ‚îÄ firebase.js      # Configura√ß√£o Firebase
‚îÇ
‚îú‚îÄ‚îÄ firestore.rules      # Regras de seguran√ßa
‚îú‚îÄ‚îÄ package.json         # Depend√™ncias
‚îú‚îÄ‚îÄ vite.config.js       # Configura√ß√£o Vite
‚îú‚îÄ‚îÄ vercel.json          # Configura√ß√£o Vercel
‚îÇ
‚îî‚îÄ‚îÄ Documenta√ß√£o/
    ‚îú‚îÄ‚îÄ RELACIONAMENTO_FIREBASE.md
    ‚îú‚îÄ‚îÄ DIAGRAMA_IMPLEMENTADO.md
    ‚îú‚îÄ‚îÄ GUIA_FICHAS_CLIENTES.md
    ‚îú‚îÄ‚îÄ SISTEMA_BAIXA_CONTAS.md
    ‚îú‚îÄ‚îÄ PARCELAMENTO_SISTEMA.md
    ‚îú‚îÄ‚îÄ INCONSISTENCIAS_CORRIGIDAS.md
    ‚îú‚îÄ‚îÄ APLICAR_REGRAS_FIREBASE.md
    ‚îú‚îÄ‚îÄ SOLUCAO_UPLOAD_CLOUDINARY.md
    ‚îú‚îÄ‚îÄ SUBSTITUICOES_POPUPS_PENDENTES.md
    ‚îî‚îÄ‚îÄ DOCUMENTACAO_COMPLETA_PROJETO.md (este arquivo)
```

---

## üîÑ Fluxos de Dados Principais

### Fluxo de Cria√ß√£o de Anamnese

1. Cliente acessa `/anamnese-cliente` ou profissional acessa `/nova-anamnese`
2. Preenche formul√°rio
3. Faz upload de foto (opcional)
4. Submit ‚Üí `usePacientes.buscarOuCriarCliente()`
5. Se foto: `compressAnamneseImage()` ‚Üí `uploadToCloudinary()`
6. Salva em `anamneses` collection
7. Atualiza/cria em `clientes` collection
8. Incrementa contador `totalAnamneses` do cliente

### Fluxo de Agendamento

1. Acessa `/agenda`
2. Clica em hor√°rio ou em agendamento existente
3. Preenche modal:
   - Cliente (busca em `clientes`)
   - Profissional (busca em `profissionais`)
   - Procedimento (busca em `catalogo_procedimentos`)
   - Data/hora/status
4. Pode fazer upload de foto do paciente
5. Salva em `agendamentos` collection com `clienteId`
6. Na pr√≥xima carga, `buscarAgendamentos()` busca foto atualizada de `clientes`

### Fluxo de Atendimento

1. Acessa `/registrar-atendimento-agendado` ou `/registrar-atendimento`
2. Seleciona/busca cliente
3. Adiciona procedimento(s)
4. Sistema carrega produtos utilizados do procedimento
5. Define valores, forma de pagamento
6. Salva:
   - Cria documento em `atendimentos`
   - D√° baixa autom√°tica no estoque de produtos
   - Cria movimenta√ß√£o em `estoque_movimentacoes`
   - Gera comiss√£o em `comissoes` (se profissional configurado)
   - Cria/atualiza conta a receber (se parcelado)
   - Atualiza contador `totalRealizados` do procedimento

### Fluxo Financeiro

#### Entrada de Produto
1. Acessa `/entrada-produtos`
2. Seleciona fornecedor
3. Adiciona produtos e quantidades
4. Define valor total e forma de pagamento
5. Salva:
   - Atualiza `estoqueAtual` em `produtos`
   - Cria `estoque_movimentacoes` (entrada)
   - Cria `contas_pagar` (se parcelado/a prazo)

#### Baixa de Conta
1. Acessa `/contas-pagar` ou `/contas-receber`
2. Clica em "Dar Baixa"
3. Confirma pagamento/recebimento
4. Sistema:
   - Atualiza `status` para "pago"
   - Registra `dataPagamento`
   - Cria `movimentacoes_financeiras`

---

## üé® Design System

### Cores Principais
```css
/* Prim√°rias */
--primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
--primary-color: #667eea;
--secondary-color: #764ba2;

/* Tons de Cinza */
--text-primary: #1d1d1f;
--text-secondary: #6e6e73;
--text-tertiary: #8e8e93;
--border-color: #d2d2d7;
--background-light: #f5f5f7;

/* Estados */
--success: #28a745;
--error: #dc3545;
--warning: #ffc107;
--info: #17a2b8;
```

### Tipografia
```css
/* Fam√≠lia */
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;

/* Tamanhos */
--font-xs: 12px;
--font-sm: 14px;
--font-base: 16px;
--font-lg: 18px;
--font-xl: 20px;
--font-2xl: 24px;
--font-3xl: 28px;
```

### Espa√ßamentos
```css
/* Touch-friendly (m√≠nimo 48px para bot√µes) */
--touch-min: 48px;
--spacing-xs: 4px;
--spacing-sm: 8px;
--spacing-md: 16px;
--spacing-lg: 24px;
--spacing-xl: 32px;
```

### Bordas e Sombras
```css
/* Border Radius */
--radius-sm: 8px;
--radius-md: 12px;
--radius-lg: 16px;

/* Shadows */
--shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
--shadow-md: 0 4px 12px rgba(0, 0, 0, 0.15);
--shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.2);
```

---

## üöÄ Deploy e CI/CD

### Processo de Deploy

1. **Commit local**: `git commit -m "mensagem"`
2. **Push para GitHub**: `git push origin main`
3. **Vercel detecta push**: Inicia build autom√°tico
4. **Build**: `npm run build` (Vite)
5. **Deploy**: Publica em produ√ß√£o
6. **URL**: https://estetica-anamnese.vercel.app

### Vari√°veis de Ambiente (Vercel)

```
VITE_FIREBASE_API_KEY=...
VITE_FIREBASE_AUTH_DOMAIN=estetica-anamnese.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=estetica-anamnese
VITE_FIREBASE_STORAGE_BUCKET=estetica-anamnese.appspot.com
VITE_FIREBASE_MESSAGING_SENDER_ID=...
VITE_FIREBASE_APP_ID=...
VITE_CLOUDINARY_CLOUD_NAME=dkliyeyoq
VITE_CLOUDINARY_API_KEY=655279166963564
```

---

## üìä Status do Projeto

### ‚úÖ Funcionalidades Implementadas

- ‚úÖ Sistema de autentica√ß√£o
- ‚úÖ Multi-tenancy (m√∫ltiplas cl√≠nicas)
- ‚úÖ CRUD completo de:
  - ‚úÖ Pacientes/Anamneses
  - ‚úÖ Procedimentos
  - ‚úÖ Produtos
  - ‚úÖ Fornecedores
  - ‚úÖ Profissionais
  - ‚úÖ Agendamentos
  - ‚úÖ Atendimentos
- ‚úÖ Sistema financeiro completo
- ‚úÖ Controle de estoque
- ‚úÖ Sistema de comiss√µes
- ‚úÖ Dashboard anal√≠tico
- ‚úÖ Upload de imagens (Cloudinary)
- ‚úÖ Sistema de notifica√ß√µes mobile-friendly
- ‚úÖ PWA (Progressive Web App)
- ‚úÖ Design responsivo (mobile-first)
- ‚úÖ Filtros e pagina√ß√£o
- ‚úÖ Relat√≥rios b√°sicos

### üîÑ Em Desenvolvimento

- üîÑ Exporta√ß√£o de relat√≥rios (PDF/Excel)
- üîÑ Notifica√ß√µes push
- üîÑ Chat/Mensagens internas
- üîÑ Integra√ß√£o com WhatsApp
- üîÑ Sistema de agendamento online (cliente)

### üìã Backlog

- üìã M√∫ltiplos idiomas (i18n)
- üìã Tema escuro (dark mode)
- üìã Backup autom√°tico
- üìã Auditoria de a√ß√µes
- üìã Permiss√µes granulares por usu√°rio

---

## üìû Contato e Suporte

**Desenvolvedor**: Alexandre Grick  
**GitHub**: https://github.com/grickalexandre/estetica-anamnese  
**Vercel**: https://estetica-anamnese.vercel.app

---

## üìù Changelog

### Vers√£o Atual (Outubro 2025)

#### Adicionado
- ‚ú® Sistema de notifica√ß√µes mobile-friendly (Toast, ConfirmModal, PromptModal)
- ‚ú® Componente EditarPaciente.vue completo
- ‚ú® Atualiza√ß√£o autom√°tica de foto do paciente na Agenda
- ‚ú® useNotifications.js composable global
- ‚ú® Substitui√ß√£o de ~50 popups por notifica√ß√µes modernas nos m√≥dulos principais

#### Modificado
- üîß Agenda.vue - Sistema de upload de foto do paciente
- üîß useAgendamento.js - Busca foto atualizada do cliente
- üîß Sidebar.vue - Bot√£o de collapse sempre vis√≠vel
- üîß Todos os bot√µes e inputs - M√≠nimo 48px (touch-friendly)

#### Corrigido
- üêõ Foto do paciente n√£o atualizava na Agenda ap√≥s edi√ß√£o
- üêõ fileInput is not defined em EditarPaciente
- üêõ Sidebar collapse button sumindo
- üêõ Espa√ßo vazio ao retrair menu

#### Removido
- üóëÔ∏è Card "Funcionalidades" da Home
- üóëÔ∏è Bot√£o "Registrar Atendimento" da Agenda
- üóëÔ∏è Menu item "Registrar Atendimento" do Sidebar
- üóëÔ∏è Se√ß√£o "Observa√ß√µes e Altera√ß√µes" de DetalhesAnamnese

---

## üôè Agradecimentos

Este projeto foi desenvolvido com o objetivo de facilitar a gest√£o de cl√≠nicas de est√©tica, proporcionando uma ferramenta moderna, mobile-first e intuitiva.

**Tecnologias utilizadas com ‚ù§Ô∏è**:
- Vue.js
- Firebase/Firestore
- Cloudinary
- Vercel
- Font Awesome

---

*Documento gerado em: Outubro 2025*  
*√öltima atualiza√ß√£o: 22/10/2025*

